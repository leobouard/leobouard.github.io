<script>
  function filterByTag(tag) {
    let linkSelected = false;
    document.querySelectorAll('a[onclick^="filterByTag"]').forEach(link => {
      if (link.getAttribute('onclick').includes(`'${tag}'`)) {
        if (link.classList.contains('selected')) {
          link.classList.remove('selected');
          clearfiltersByTag();
          linkSelected = true;
        }
      }
    });

    if (linkSelected) {
      return;
    }

    clearfilterByTag();
    document.querySelectorAll('article').forEach(article => {
      const tags = article.querySelector('.article-tags');
      if (!tags || !tags.textContent.includes(tag)) {
        article.style.display = 'none';
      }
    });
    document.querySelectorAll('a[onclick^="filterByTag"]').forEach(link => {
      if (link.getAttribute('onclick').includes(`'${tag}'`)) {
        link.classList.add('selected');
      }
    });
  }

  function clearfilterByTag() {
    document.querySelectorAll('article').forEach(article => {
      article.style.display = '';
    });
    document.querySelectorAll('a[onclick^="filterByTag"]').forEach(link => {
      link.classList.remove('selected');
    });
  }
</script>